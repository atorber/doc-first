# 6. 故障排查与系统级调试

## 6.1 系统级调试方法论

### 6.1.1 系统级调试的核心理念

在Vibe Coding中，开发者不再逐行调试代码，而是：
1. **从系统行为出发** - 观察整体表现而非局部
2. **引导AI修复** - 将问题描述清晰传达给AI
3. **系统验证** - 通过测试验证修复效果

### 6.1.2 系统级诊断流程

#### 第一步：症状观察
```
**问题症状**: 
- [具体的错误表现]
- [发生的时间和环境]
- [影响范围]
```

#### 第二步：系统行为分析
```
**系统行为**: 
- [正常运行时的行为]
- [故障时的行为]
- [行为差异分析]
```

#### 第三步：根本原因推测
```
**可能原因**:
1. [原因1 - 可能性评估]
2. [原因2 - 可能性评估]
3. [原因3 - 可能性评估]

**优先级**: [最可能的原因]
```

#### 第四步：AI引导修复
将上述信息清晰地传达给AI：
```
系统出现问题：[问题描述]
当前表现：[系统行为]
可能原因：[你的初步分析]
请帮我分析根本原因并提供修复方案。
```

### 6.1.3 系统级调试检查清单

- [ ] 已收集完整的错误日志
- [ ] 已观察系统整体行为
- [ ] 已分析可能的原因
- [ ] 已向AI清晰描述问题
- [ ] 已对AI提供的方案进行审查
- [ ] 已通过测试验证修复

## 6.2 常见问题

### 服务无法启动

**症状**: 服务启动后立即退出

**排查步骤**:
1. 检查端口是否被占用
2. 检查环境变量是否正确
3. 查看启动日志

**解决方案**:
```bash
# 检查端口
lsof -i :3000

# 检查环境变量
env | grep DATABASE
```

### 数据库连接失败

**症状**: 应用无法连接数据库

**排查步骤**:
1. 检查数据库服务状态
2. 验证连接字符串
3. 检查网络连通性

**解决方案**:
```bash
# 测试数据库连接
psql -h host -U user -d dbname

# 检查网络
nc -zv hostname 5432
```

## 6.2 应急响应

### P0 - 紧急故障
- 响应时间: 15 分钟
- 处理流程: 立即定位、快速修复、事后复盘

### P1 - 高优先级
- 响应时间: 1 小时
- 处理流程: 评估影响、制定方案、执行修复

## 6.3 故障报告模板

```
故障时间: 
影响范围: 
症状描述: 
根本原因: 
处理过程: 
预防措施: 
```
